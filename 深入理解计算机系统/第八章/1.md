							***异常***

现代系统通过使控制流发生突变来对这些情况做出反应。一般而言，这些突变我们称之为异常控制流(Exceptional Control Flow, ECF)。

​	理解ECF很重要：

  - ***理解ECF将帮助理解重要的系统概念***。ECF是操作系统用来实现I/O、进程和虚拟内存的基本机		制。
  - ***理解ECF将帮助理解应用程序是如何与操作系统交互的***。应用程序通过使用一个叫做陷阱(trap)或者系统调用(system call)的ECF形式，向操作系统请求服务。
		- ***理解ECF将帮助编写有趣的新的应用程序***。操作系统为应用程序提供了强大的ECF机制，用来创建新进程、等待进程终止、通知其他进程系统中的异常事件，以及检测和响应这些事件。
		- ***理解ECF将帮助理解并发***。ECF是计算机系统中实现并发的基本机制。
		- ***理解ECF将帮助理解软件异常如何工作***。像C++和Java这样的语言通过try、catch以及throw语句来提供软件异常机制。

异常处理类似于过程调用，但是有一些重要的不同之处：

- 过程调用时，在跳转到处理程序之前，处理器将返回地址压入栈中。然而，根据异常的类型，返回地址要么是当前指令(当事件发生时正在执行的指令)，要么是下一条指令(如果事件不发生，将会在当前指令后执行的指令)
- 处理器也把一些额外的处理器状态压到栈里，再处理程序返回时，重新开始执行被中断的程序会需要这些状态。
- 如果控制从用户程序转移到内核，所有这些项目都被压到内核栈中，而不是压到用户栈中
- 异常处理程序运行在内核模式下，这意味着它们对所有的系统资源都有完全的访问权限。

 异常可以分为四类：中断(interrupt)、陷阱(trap)、故障(fault)和终止(abort).图8-4中的表对这些类别的属性做了小结。

![](D:\typora\page\StudyNote\深入理解计算机系统\img\异常类别.jpg)

