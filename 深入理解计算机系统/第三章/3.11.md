				***浮点代码***

处理器的浮点体系结构包括多个方面，会影响对浮点数据操作的程序如何被映射到机器上，包括：

- 如何存储和访问浮点数值。通常是通过某种寄存器方式来完成。

- 对浮点数据操作的指令
- 向函数传递浮点数参数和从函数返回浮点数结果的规则
- 函数调用过程中保存寄存器的规则————例如，一些寄存器被指定为调用者保存，而其他的被指定为被调用者保存

AVX浮点体系结构允许数据存储在16个YMM寄存器中。它们的名字为%ymm0~%ymm15.每个YMM寄存器都是256位(32字节)。当标量数据操作时，这些寄存器只保存浮点数，而且只使用低32位(对于float)或者64位(对于double)。汇编代码用寄存器的SSE XMM寄存器名字%xmm~%xmm15来引用它们，每个XMM寄存器都是对应的YMM寄存器的低128位(16字节)。

​	

![](..\img\媒体寄存器.jpg)

下图给出了一组在内存和XMM寄存器之间以及从一个XMM寄存器到另一个不做任何转换的传送浮点数的指令。

![](..\img\浮点传送指令.jpg)



图3-47和3-48给出了在浮点数和整数数据类型之间以及不同浮点格式之间进行转换的指令集和。



![](..\img\浮点转换指令.jpg)



在x86-64中，XMM寄存器用来向函数传递浮点参数，以及从函数返回浮点值。可以看到如下规则：

- XMM寄存器%xmm0~%xmm7最多可以传递8个浮点参数。按照参数列出的顺序使用这些寄存器。可以通过栈传递额外的浮点参数。
- 函数使用寄存器%xmm0来返回浮点值。
- 所有的XMM寄存器都是调用者保存的。被调用者可以不用保存就覆盖这些寄存器中任意一个。



图3-49描述了一组执行算术运算的标量AVX2浮点指令。



![](..\img\标量浮点算术运算.jpg)







